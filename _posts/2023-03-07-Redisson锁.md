---
title: Redisson锁
author: Travis <Hongxu Wei>
date: 2023-03-07 22:09:14 +0800
categories: [Java Learning Space]
tags: [redisson redis]
math: false
---

[8. 分布式锁和同步器 - 8.2. 公平锁（Fair Lock） - 《Redisson 使用手册》 - 书栈网 · BookStack](https://www.bookstack.cn/read/redisson-wiki-zh/spilt.2.8.-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E5%92%8C%E5%90%8C%E6%AD%A5%E5%99%A8.md)

## 1、可重入锁

## 2、公平锁

**公平锁遵循先到先得的原则**

## 3、联锁

联锁（RedissonMultiLock）对象可以将多个RLock对象关联为一个联锁，实现加锁和解锁功能。每个RLock对象实例可以来自于不同的Redisson实例。==所有的锁上锁成功才算成功==

## 4、红锁

可以使用红锁来解决主从架构锁失效问题：就是说在主从架构系统中，线程A从master中获取到分布式锁，数据还未同步到slave中时master就挂掉了，slave成为新的master，其它线程从新的master获取锁也成功了，就会出现并发安全问题。

**红锁算法**

 （1）应用程序获取系统当前时间，毫秒级
 
 （2）应用程序使用相同的key、value值依次从多个Redis实例中获取锁，如果某一个节点超过一定时间仍然没有获取到锁则直接放弃，尽快尝试从下一个Redis节点获取锁，以避免被宕机的节点阻塞。
 
（3）计算获取锁的消耗时间=客户端程序当前时间-step1中的时间，获取锁的消耗时间小于总的锁定时间（例如30s）并且半数以上节点（假如有5个节点，则至少有3个节点）获取锁成功，才认为获取锁成功。

（4）计算剩余锁定时间=总的锁定时间-step3中的消耗时间

（5）如果获取锁失败，对所有的Redis节点释放锁（无论加锁是否成功）

## 5、读写锁

## 6、信号量

## 7、可过期性信号量

## 8、闭锁

